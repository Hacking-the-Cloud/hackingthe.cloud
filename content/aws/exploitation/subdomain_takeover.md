---
author_name: Sena Yakut
title: Preventing AWS Subdomain Takeover:Cases and Strategies for Enhanced Security
description: AWS subdomain takeover example cases and prevention methods
---

# Preventing AWS Subdomain Takeover:Cases and Strategies for Enhanced Security

![](https://miro.medium.com/v2/resize:fit:4800/format:webp/1*FnajFSY8Q_6OIwkGsKza9w.png)

Subdomain takeover is a security vulnerability that occurs when a subdomain (mywebsite.example.com) points to a service that the original owner no longer controls or uses. This critical case causes reputational damage, spoofing the clients, being blacklisted from trusted parties, and using dangerous content in phishing scenarios. From the security sharing responsibility model perspective, managing domains and resources is customer responsibility, so we need to mitigate this. In this blog, we will talk about the steps, the scenarios in AWS and how can we protect them. Let‚Äôs start! üëΩ

**General Takeover Steps:**
1) Clients see and browse the victim's website as usual.
2) Website admins delete the AWS resources that are connected to the subdomain and forget to delete the subdomain from domain records.
3) The attacker checks the website and sees there is no resource here.
4) The attacker checks DNS records and gets the information.
5) The attacker creates the required resource in their AWS environment.
6) The attacker uses the subdomain for their own.

**Subdomain Takeover Cases:**

***1-) Static Website Hosting on S3:*** If you hosted a website on S3, decided to use another technology, and deleted the bucket, not the subdomain, you are exploitable with a subdomain takeover case. Let‚Äôs see an example of it:

We see a cool website in there:

![](https://miro.medium.com/v2/resize:fit:4800/format:webp/1*Z0h9MI2rSemzkuNOWhlyjg.png)

The website admin deletes the S3 bucket but forgets the CNAME record deletion. The attacker checks the website and sees the error message.

![](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdbEByjlrPzv6EQjBc1SFQ.png)
The attacker checks DNS records and catches the CNAME records, S3 bucket names, and region information.

![image](https://github.com/Hacking-the-Cloud/hackingthe.cloud/assets/42169819/f55f5ebe-00aa-4629-af3b-c968e1f38db6)

When you use the static website hosting feature from S3, the URL is like <yourbucketname>.s3-website-<region>.amazonaws.com. So, getting the bucket name and region is enough to create the same bucket in the attacker‚Äôs AWS account with dangerous content.

![image](https://github.com/Hacking-the-Cloud/hackingthe.cloud/assets/42169819/27a0cdfe-533d-4eb5-bda2-6cc508f92970)

***2-) CloudFront + S3:*** It‚Äôs a similar case to website hosting. The only difference here is there is a CloudFront implementation in front of the S3. It‚Äôs a little bit tricky from the attacker's perspective, yes S3 cases are the same but CloudFront needs invalidation to see the changes in the website or other resources.

![image](https://github.com/Hacking-the-Cloud/hackingthe.cloud/assets/42169819/20edea50-88bf-4e0e-a057-5f8af7c0dfd5)

***3-) Elastic Beanstalk:*** AWS Elastic Beanstalk is a service for deploying and scaling web applications and services. If an Elastic Beanstalk environment is misconfigured or becomes unused, an attacker could potentially register the same subdomain and take over control.

A website admin adds a domain for the company. After adding, the admin deletes the all environment but forgets the DNS records.

![image](https://github.com/Hacking-the-Cloud/hackingthe.cloud/assets/42169819/2a72b7b8-8528-4dbb-b3ee-39eadb411728)

The attacker checks the DNS records and creates an app for a dangerous environment.

![image](https://github.com/Hacking-the-Cloud/hackingthe.cloud/assets/42169819/d5a21f4d-3256-4fbb-b6f2-76f689925fc9)

**üò∞ Recommendations to Prevent:**
- Review and audit DNS records regularly,
- Delete unused CNAMe or other DNS records,
- Monitor and alert your cloud configurations and resources,
- If you‚Äôre using IaC, add a deletion process to it. Sometimes IaC forgets to delete all records.

Thank you for reading! Stay safe in the cloud! ‚õÖÔ∏è

